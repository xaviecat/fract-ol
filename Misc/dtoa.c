#include <stdio.h>
#include <stdlib.h>
#include <float.h>

static size_t	get_len(double n, long num, size_t len, size_t precision)
{
	if (num == 0)
		len = 1;
	while (num != 0)
	{
		len++;
		num /= 10;
	}
	len += precision + 1;
	if (n < 0)
		len++;
	return (len);
}

static size_t	get_int_part(char *str, double n, long num, size_t i)
{
	long	tmp;
	size_t	ret;

	ret = i;
	num = (long)n;
	tmp = num;
	while (tmp)
	{
		tmp /= 10;
		ret++;
	}
	while (num)
	{
		str[ret - 1] = (num % 10) + '0';
		num /= 10;
		ret--;
		i++;
	}
	if (n < 1 && n > -1)
		str[i++] = '0';
	return (i - 1);
}

static void	get_dec_part(char *str, double dec, long num, size_t len)
{
	size_t	i;

	i = 0;
	str[i] = '.';
	i++;
	while (i < len)
	{
		dec *= 10;
		num = (long)dec;
		str[i] = (num % 10) + '0';
		dec -= (double)num;
		i++;
	}
	str[i] = '\0';
}

/* Precision 15 max */
char	*ft_dtoa(double n, size_t precision)
{
	char	*str;
	size_t	i;
	size_t	len;
	double	dec;
	long	num;

	len = 0;
	num = (long)n;
	len = get_len(n, num, len, precision);
	str = malloc(sizeof(char) * (len + 1));
	if (str == NULL)
		return (NULL);
	i = 0;
	if (n < 0)
	{
		str[i++] = '-';
		n = -n;
	}
	i = get_int_part(str, n, num, i);
	dec = n - (double)num;
	len -= i;
	get_dec_part(&str[i + 1], dec, num, len);
	return (str);
}

int	main(void)
{
	double		nbr[600] =
	52.589047686, 455.6215668342, 405.7659472813, 694.6528186824, 154.626880003, 133.9337950903, 59.0569951837, 154.8084477167, 727.6872728154, 472.6249893879, 339.9887483064, 876.9485421413, 527.599193632, 518.1900147801, 983.082742841, 855.7508381339, 608.2598772893, 857.3325632733, 308.9653050932, 894.1067804038, 72.9240269577, 458.433118486, 347.4124722255, 497.3616333019, 875.0674929237, 631.5343159849, 114.9377512652, 948.372935971, 49.4165382788, 520.4930913306, 970.0163001795, 521.0721584726, 222.2090598718, 276.3051050284, 762.6663102585, 845.7470048302, 586.0394072035, 257.7942658238, 328.3249793138, 739.5405104042, 581.8260927358, 511.2982406641, 445.4176166064, 582.8551654713, 77.0174851678, 708.0448806049, 820.1075794893, 738.4095458707, 7.8935748883, 945.7113001224, 686.0841445886, 186.8432327341, 437.2593059955, 357.7265147198, 694.9505424876, 805.3305799464, 655.2377329665, 857.3065630246, 331.2862062628, 117.5036354328, 116.0955440957, 469.2322125515, 95.8554420284, 446.3767978858, 933.3394959436, 201.0896259589, 749.3469198012, 512.0452271453, 468.1711278442, 965.1429489451, 540.8948312005, 877.2885922358, 562.5703567088, 780.09765743, 849.1872311552, 864.5075787243, 129.5017996018, 355.7645535617, 649.1455184851, 670.13051784, 191.0966628814, 21.4353921215, 176.7695182086, 534.48998572, 815.9577446864, 116.8825746164, 757.1650300595, 573.7700991117, 672.7594578791, 368.8459904086, 179.1421340621, 224.1490782174, 453.4664136541, 915.0891853627, 638.5575422899, 954.8845173316, 705.5238947931, 544.9469521274, 467.4611369755, 526.7913902657, -752.589047686, -455.6215668342, -405.7659472813, -694.6528186824, -154.626880003, -133.9337950903, -59.0569951837, -154.8084477167, -727.6872728154, -472.6249893879, -339.9887483064, -876.9485421413, -527.599193632, -518.1900147801, -983.082742841, -855.7508381339, -608.2598772893, -857.3325632733, -308.9653050932, -894.1067804038, -72.9240269577, -458.433118486, -347.4124722255, -497.3616333019, -875.0674929237, -631.5343159849, -114.9377512652, -948.372935971, -49.4165382788, -520.4930913306, -970.0163001795, -521.0721584726, -222.2090598718, -276.3051050284, -762.6663102585, -845.7470048302, -586.0394072035, -257.7942658238, -328.3249793138, -739.5405104042, -581.8260927358, -511.2982406641, -445.4176166064, -582.8551654713, -77.0174851678, -708.0448806049, -820.1075794893, -738.4095458707, -7.8935748883, -945.7113001224, -686.0841445886, -186.8432327341, -437.2593059955, -357.7265147198, -694.9505424876, -805.3305799464, -655.2377329665, -857.3065630246, -331.2862062628, -117.5036354328, -116.0955440957, -469.2322125515, -95.8554420284, -446.3767978858, -933.3394959436, -201.0896259589, -749.3469198012, -512.0452271453, -468.1711278442, -965.1429489451, -540.8948312005, -877.2885922358, -562.5703567088, -780.09765743, -849.1872311552, -864.5075787243, -129.5017996018, -355.7645535617, -649.1455184851, -670.13051784, -191.0966628814, -21.4353921215, -176.7695182086, -534.48998572, -815.9577446864, -116.8825746164, -757.1650300595, -573.7700991117, -672.7594578791, -368.8459904086, -179.1421340621, -224.1490782174, -453.4664136541, -915.0891853627, -638.5575422899, -954.8845173316, -705.5238947931, -544.9469521274, -467.4611369755, -526.7913902657, 52.589047686, 55.6215668342, 05.7659472813, 94.6528186824, 54.626880003, 33.9337950903, 9.0569951837, 54.8084477167, 27.6872728154, 72.6249893879, 39.9887483064, 76.9485421413, 27.599193632, 18.1900147801, 83.082742841, 55.7508381339, 08.2598772893, 57.3325632733, 08.9653050932, 94.1067804038, 2.9240269577, 58.433118486, 47.4124722255, 97.3616333019, 75.0674929237, 31.5343159849, 14.9377512652, 48.372935971, 9.4165382788, 20.4930913306, 70.0163001795, 21.0721584726, 22.2090598718, 76.3051050284, 62.6663102585, 45.7470048302, 86.0394072035, 57.7942658238, 28.3249793138, 39.5405104042, 81.8260927358, 11.2982406641, 45.4176166064, 82.8551654713, 7.0174851678, 08.0448806049, 20.1075794893, 38.4095458707, .8935748883, 45.7113001224, 86.0841445886, 86.8432327341, 37.2593059955, 57.7265147198, 94.9505424876, 05.3305799464, 55.2377329665, 57.3065630246, 31.2862062628, 17.5036354328, 16.0955440957, 69.2322125515, 5.8554420284, 46.3767978858, 33.3394959436, 01.0896259589, 49.3469198012, 12.0452271453, 68.1711278442, 65.1429489451, 40.8948312005, 77.2885922358, 62.5703567088, 80.09765743, 49.1872311552, 64.5075787243, 29.5017996018, 55.7645535617, 49.1455184851, 70.13051784, 91.0966628814, 1.4353921215, 76.7695182086, 34.48998572, 15.9577446864, 16.8825746164, 57.1650300595, 73.7700991117, 72.7594578791, 68.8459904086, 79.1421340621, 24.1490782174, 53.4664136541, 15.0891853627, 38.5575422899, 54.8845173316, 05.5238947931, 44.9469521274, 67.4611369755, 26.7913902657, -52.589047686, -55.6215668342, -05.7659472813, -94.6528186824, -54.626880003, -33.9337950903, -9.0569951837, -54.8084477167, -27.6872728154, -72.6249893879, -39.9887483064, -76.9485421413, -27.599193632, -18.1900147801, -83.082742841, -55.7508381339, -08.2598772893, -57.3325632733, -08.9653050932, -94.1067804038, -2.9240269577, -58.433118486, -47.4124722255, -97.3616333019, -75.0674929237, -31.5343159849, -14.9377512652, -48.372935971, -9.4165382788, -20.4930913306, -70.0163001795, -21.0721584726, -22.2090598718, -76.3051050284, -62.6663102585, -45.7470048302, -86.0394072035, -57.7942658238, -28.3249793138, -39.5405104042, -81.8260927358, -11.2982406641, -45.4176166064, -82.8551654713, -7.0174851678, -08.0448806049, -20.1075794893, -38.4095458707, -.8935748883, -45.7113001224, -86.0841445886, -86.8432327341, -37.2593059955, -57.7265147198, -94.9505424876, -05.3305799464, -55.2377329665, -57.3065630246, -31.2862062628, -17.5036354328, -16.0955440957, -69.2322125515, -5.8554420284, -46.3767978858, -33.3394959436, -01.0896259589, -49.3469198012, -12.0452271453, -68.1711278442, -65.1429489451, -40.8948312005, -77.2885922358, -62.5703567088, -80.09765743, -49.1872311552, -64.5075787243, -29.5017996018, -55.7645535617, -49.1455184851, -70.13051784, -91.0966628814, -1.4353921215, -76.7695182086, -34.48998572, -15.9577446864, -16.8825746164, -57.1650300595, -73.7700991117, -72.7594578791, -68.8459904086, -79.1421340621, -24.1490782174, -53.4664136541, -15.0891853627, -38.5575422899, -54.8845173316, -05.5238947931, -44.9469521274, -67.4611369755, -26.7913902657, 2.589047686, 5.6215668342, 5.7659472813, 4.6528186824, 4.626880003, 3.9337950903, 1.0569951837, 4.8084477167, 7.6872728154, 2.6249893879, 9.9887483064, 6.9485421413, 7.599193632, 8.1900147801, 3.082742841, 5.7508381339, 8.2598772893, 7.3325632733, 8.9653050932, 4.1067804038, 1.9240269577, 8.433118486, 7.4124722255, 7.3616333019, 5.0674929237, 1.5343159849, 4.9377512652, 8.372935971, 1.4165382788, 0.4930913306, 0.0163001795, 1.0721584726, 2.2090598718, 6.3051050284, 2.6663102585, 5.7470048302, 6.0394072035, 7.7942658238, 8.3249793138, 9.5405104042, 1.8260927358, 1.2982406641, 5.4176166064, 2.8551654713, 1.0174851678, 8.0448806049, 0.1075794893, 8.4095458707, 1.8935748883, 5.7113001224, 6.0841445886, 6.8432327341, 7.2593059955, 7.7265147198, 4.9505424876, 5.3305799464, 5.2377329665, 7.3065630246, 1.2862062628, 7.5036354328, 6.0955440957, 9.2322125515, 1.8554420284, 6.3767978858, 3.3394959436, 1.0896259589, 9.3469198012, 2.0452271453, 8.1711278442, 5.1429489451, 0.8948312005, 7.2885922358, 2.5703567088, 0.09765743, 9.1872311552, 4.5075787243, 9.5017996018, 5.7645535617, 9.1455184851, 0.13051784, 1.0966628814, 1.4353921215, 6.7695182086, 4.48998572, 5.9577446864, 6.8825746164, 7.1650300595, 3.7700991117, 2.7594578791, 8.8459904086, 9.1421340621, 4.1490782174, 3.4664136541, 5.0891853627, 8.5575422899, 4.8845173316, 5.5238947931, 4.9469521274, 7.4611369755, 6.7913902657, -2.589047686, -5.6215668342, -5.7659472813, -4.6528186824, -4.626880003, -3.9337950903, -.0569951837, -4.8084477167, -7.6872728154, -2.6249893879, -9.9887483064, -6.9485421413, -7.599193632, -8.1900147801, -3.082742841, -5.7508381339, -8.2598772893, -7.3325632733, -8.9653050932, -4.1067804038, -.9240269577, -8.433118486, -7.4124722255, -7.3616333019, -5.0674929237, -1.5343159849, -4.9377512652, -8.372935971, -1.4165382788, -0.4930913306, -0.0163001795, -1.0721584726, -2.2090598718, -6.3051050284, -2.6663102585, -5.7470048302, -6.0394072035, -7.7942658238, -8.3249793138, -9.5405104042, -1.8260927358, -1.2982406641, -5.4176166064, -2.8551654713, -1.0174851678, -8.0448806049, -0.1075794893, -8.4095458707, -1.8935748883, -5.7113001224, -6.0841445886, -6.8432327341, -7.2593059955, -7.7265147198, -4.9505424876, -5.3305799464, -5.2377329665, -7.3065630246, -1.2862062628, -7.5036354328, -6.0955440957, -9.2322125515, -1.8554420284, -6.3767978858, -3.3394959436, -1.0896259589, -9.3469198012, -2.0452271453, -8.1711278442, -5.1429489451, -0.8948312005, -7.2885922358, -2.5703567088, -0.09765743, -9.1872311552, -4.5075787243, -9.5017996018, -5.7645535617, -9.1455184851, -0.13051784, -1.0966628814, -1.4353921215, -6.7695182086, -4.48998572, -5.9577446864, -6.8825746164, -7.1650300595, -3.7700991117, -2.7594578791, -8.8459904086, -9.1421340621, -4.1490782174, -3.4664136541, -5.0891853627, -8.5575422899, -4.8845173316, -5.5238947931, -4.9469521274, -7.4611369755, -6.7913902657};
	char		*str;
	int			i;

	i = 0;
	while (i < 300)
	{
		str = ft_dtoa(nbr[i], 30);
		printf("%.31f\n%s\n", nbr[i], str);
		free(str);
		i++;
	}
	return (0);
}


